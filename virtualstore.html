<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Virtual Store</title>
    <meta name="description" content="Virtual Store">
	
	<!-- Basic A-Frame library -->
	<script src="https://aframe.io/releases/0.2.0/aframe.min.js"></script>

	<!-- Needed to add Text -->
	<script src="http://www.mattnutsch.com/development/breakoutvr/aframe-text-component.min.js"></script>

  </head>
  <body>
	
	<a-scene>	
		
		<!-- Assets -->
		<a-assets>
		
			<!-- Mixins. -->
			<a-mixin id="red" material="color: red"></a-mixin>
			<a-mixin id="green" material="color: green"></a-mixin>
			<a-mixin id="blue" material="color: blue; opacity: 0.5"></a-mixin>
			<a-mixin id="url-red" material="color: #d63959"></a-mixin>
			<a-mixin id="cube" geometry="primitive: box"></a-mixin>
			
			<!-- iPhone 8 -->	
			<a-asset-item id="iphone_8-obj" src="static/iphone_8.obj"></a-asset-item>
			<a-asset-item id="iphone_8-mtl" src="static/iphone_8.mtl"></a-asset-item>
		
		</a-assets>
		
		<!-- set game background planes. -->
		<!--<a-plane rotation="-90 0 0" width="4" height="4" color="#a0a0a0"></a-plane>-->
		<a-plane position="0 2 -2" rotation="0 0 0" width="4" height="4" color="#bfabce"></a-plane>
		
		<a-entity id="product0" obj-model="obj: #iphone_8-obj; mtl: #iphone_8-mtl" position="0 2.5 0" rotation="0 0 180" scale="0.005 0.005 0.005" material="side: double"></a-entity>
		
		<!-- background 360 image. -->
		<a-sky color="#E20074" ></a-sky>
		
		<!-- Set camera starting position. -->
		<a-entity position="0 1 3.8">
			<a-camera look-controls id="myCamera" wasd-controls="enabled: false">
				<a-cursor id="cursor" material="color: gray; opacity: 0.5">
				</a-cursor>
			</a-camera>
		</a-entity>

		<!-- Set light position. -->
		<a-light
			type="directional"
			color="#FFF"
			intensity="0.1"
			position="-1 1 2">
		</a-light>
		<a-light
			type="ambient"
			color="#FFF">
		</a-light>
		
		<a-entity bmfont-text="text: HELLO!; color: #333" position="0 0 -5"></a-entity>
		
		<script>		
		//wait until the page loads to perform the following
		window.onload = function () 
		{
			//init vars
			var scene = document.querySelector('a-scene'); //assign a name to the A-Frame scene
		
			var productObjects = []; //objects
			var productObjectsX = []; //object x positions
			var productObjectsY = []; //object y positions
			var productObjectsZ = []; //object z positions
			
			var maxXPosition = 5;
			var minXPosition = -5;
			
			//velocity for movement
			var viewPosition = 0;
			var productVelocityX = 0;
			var velocityChangeSpeed = 0.1;
			
			var intervalLength = 25; //determines the speed of the app
		
			//temp placeholders for objects
			var blockWidth = 0.2;
			var blockHeight = 0.2;
			var blockDepth = 0.2;
			var blockColor = '#4CC3D9';
			
			//declare a temp object
			productObjects[0] = document.createElement('a-box');
			productObjects[0].setAttribute('width', blockWidth);
			productObjects[0].setAttribute('height', blockHeight);
			productObjects[0].setAttribute('depth', blockDepth);
			productObjects[0].setAttribute('color', blockColor);
			
			/*
			productObjects[0] = document.createElement('a-obj-model');
			productObjects[0].setAttribute('obj', '#iphone_8-obj');
			productObjects[0].setAttribute('mtl', '#iphone_8-mtl');
			productObjects[0].setAttribute('position', '3 2.5 0');
			productObjects[0].setAttribute('rotation', '0 0 180');
			productObjects[0].setAttribute('scale', '1 1 1');
			*/
			//<a-entity obj-model="obj: #iphone_8-obj; mtl: #iphone_8-mtl" position="0 2.5 0" rotation="0 0 180" scale="0.005 0.005 0.005" material="side: double"></a-entity>
		
			//declare temp object location
			productObjectsX[0] = -1.5;
			productObjectsY[0] = 3.5;
			productObjectsZ[0] = -1;
			
			//add the temp object to the scene
			scene.appendChild(productObjects[0]);
			productObjects[0].setAttribute('position', productObjectsX[0] + ' ' + productObjectsY[0] + ' ' + productObjectsZ[0]);
		
			//Display a welcome message	
			var welcomeMessage = "Hey Guest! Welcome.";
			var welcomeText = document.createElement('a-entity');
			welcomeText.setAttribute('mixin', 'blue');
			scene.appendChild(welcomeText);
			welcomeText.setAttribute('text', 'text: ' + welcomeMessage);
			welcomeText.setAttribute('position', '-3.5 3.8 -0.8');
			welcomeText.setAttribute('size', '0.75');
			
			function moveObjects()
			{
				//move the products				
				viewPosition = (myCamera.getAttribute('rotation').y / -19) * 1.25;
				if(viewPosition < -1.25)
				{
					productVelocityX = -1 * velocityChangeSpeed;
				}
				else if(viewPosition > 1.25)
				{
					productVelocityX = velocityChangeSpeed;
				}
				else
				{
					productVelocityX = 0;
				}
				
				productObjectsX[0] = productObjectsX[0] + productVelocityX;
			}
			
			//stop the objects from moving when they reach the boundary
			function checkCollisions()
			{
				//dev note, make this a for loop
				
					if(productObjectsX[0] > maxXPosition)
					{
						productObjectsX[0] = maxXPosition
					}
					
					if(productObjectsX[0] < minXPosition)
					{
						productObjectsX[0] = minXPosition
					}
				
			}
			
			//Timer for the app
			setInterval(function()
			{
				checkCollisions(); //check to see if anything collided
				moveObjects(); //update the X and Y coordinates of game objects
				
				//make this into a for loop
				productObjects[0].setAttribute('position', productObjectsX[0] + ' ' + productObjectsY[0] + ' ' + productObjectsZ[0]); //reposition the products
						
			}, intervalLength);
			
		}
		</script>
		
	</a-scene>	

  </body>
</html>